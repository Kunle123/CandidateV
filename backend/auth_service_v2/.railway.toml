[build]
builder = "nixpacks"
buildCommand = "pip install -r requirements.txt"

[deploy]
startCommand = "alembic upgrade head && uvicorn app.main:app --host 0.0.0.0 --port $PORT"
restartPolicyType = "on_failure"
restartPolicyMaxRetries = 5

[env]
ENVIRONMENT = "production"
DEBUG = "false"
POSTGRES_SERVER = "monorail.proxy.rlwy.net"
POSTGRES_USER = "${RAILWAY_POSTGRESQL_USER}"
POSTGRES_PASSWORD = "${RAILWAY_POSTGRESQL_PASSWORD}"
POSTGRES_DB = "${RAILWAY_POSTGRESQL_DATABASE}"
POSTGRES_PORT = "${RAILWAY_POSTGRESQL_PORT}"
DATABASE_URL = "${RAILWAY_POSTGRESQL_CONNECTION_URL}"

# API Configuration
API_V1_STR = "/api/v1"
PROJECT_NAME = "Auth Service"

# Security
SECRET_KEY = "${RAILWAY_SECRET_KEY}"
ALGORITHM = "HS256"
ACCESS_TOKEN_EXPIRE_MINUTES = "30"
REFRESH_TOKEN_EXPIRE_MINUTES = "10080"  # 7 days
PASSWORD_RESET_TOKEN_EXPIRE_MINUTES = "15"
EMAIL_VERIFICATION_TOKEN_EXPIRE_MINUTES = "1440"  # 24 hours

# CORS Configuration
BACKEND_CORS_ORIGINS = '["*"]'

# Database Connection Pool
POOL_SIZE = "5"
MAX_OVERFLOW = "10"
POOL_TIMEOUT = "30"
POOL_RECYCLE = "1800"
POOL_PRE_PING = "true"

# Email Settings
SMTP_TLS = "true"
SMTP_PORT = "587"
SMTP_HOST = "smtp.gmail.com"
SMTP_USER = "${RAILWAY_SMTP_USER}"
SMTP_PASSWORD = "${RAILWAY_SMTP_PASSWORD}"
EMAILS_FROM_EMAIL = "${RAILWAY_FROM_EMAIL}"
EMAILS_FROM_NAME = "Auth Service" 